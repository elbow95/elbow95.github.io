---
layout: post
title: Hash
date: '2020-01-20'
categories: [Hash, Interview]
---

### 哈希表

- 哈希表（HashTable）也叫散列表，是根据关键码值（key-value）而直接访问的数据结构
- 可以把关键码值**映射**到表中的一个位置来访问记录，加快查找的速度
- 这个映射函数叫做**哈希函数**（散列函数），存放记录的数组叫做哈希表
- `storage location(bucket)=H(key)`，`H()`被称为哈希函数（散列函数），采用哈希技术将记录存储在一块连续的存储空间

### 哈希表的存取

- 存值：把key通过一个固定的哈希函数转换为一个整形数字，然后对该数字长度进行取余，取余结果当作数组的下标，将value存储在以该数字为下标的数组空间中
- 取值：再次使用哈希函数将key转换为对应的数组下标，并定位到哈希表中获取value

### 哈希的应用

- 加密算法：把不同长度的信息转换为杂乱的128位的编码（MD5）
- 查找：当知道key值之后，可以直接计算出元素在集合中的位置

### 常见的哈希函数

- 直接定址法：取关键字key或者关键字中的某个线性函数值作为散列地址，即`H(key)=key or H(key)=a*key+b; a,b=常数`
- 除留余数法：取关键字key被某个不大于哈希表大小m的数p求余
- 数字分析法：当关键字位数大于地址位数，对关键字的各位分布进行分析，选出分布均匀的任意几位作为哈希地址
- 平方取中法：计算关键字值的平方，然后取平均值中间几位作为哈希地址
- 折叠法：将关键字分为位数相同的及部分，然后取这及部分的叠加和（进位舍去）作为哈希地址

### 哈希冲突

- 不同关键字通过相同哈希函数计算处相同的哈希地址，这种现象称为哈希冲突
- 处理方法：
  - 链地址法：key相同的使用单链表连接（数组+链表）
  - 开放定址法：
    - 线性探测法：放到`H(key)`的下一个位置，`Hi=(H(key)+i)%m`
    - 二次探测法：放到计算位置后偏移量（1，2，3...）的二次方地址处
    - 随机探测法：`Hi=(H(key)+random)%m`

### STL中的hash_map和map

- 区别：
  - 构造函数，hash_map需要提供哈希函数；map只需要比较函数
  - 存储结构，hash_map使用hash表实现；map一般使用红黑树实现
- 怎么选择：权衡三个因素，查找速度，数据量，内存使用
- **hash_map**扩容时发生什么
  - 创建一个新桶，该桶是原来桶两倍大最接近的质数（判断质数：用n除以2到`sqrt()n`的所有整数）
  - 将原来桶里的数通过指针的转换，插入到新桶里
  - 通过swap函数将新桶和旧桶交换，销毁旧桶